WT_Ac_1 = read.table("ChIP_H3Ac_WT_1_TEelement.bed")
WT_Ac_2 = read.table("ChIP_H3Ac_WT_2_TEelement.bed")
hda6_Ac_1 = read.table("ChIP_H3Ac_hda6_1_TEelement.bed")
hda6_Ac_2 = read.table("ChIP_H3Ac_hda6_2_TEelement.bed")
ldl12_Ac_1 = read.table("ChIP_H3Ac_ldl12_1_TEelement.bed")
ldl12_Ac_2 = read.table("ChIP_H3Ac_ldl12_2_TEelement.bed")
hda6ldl12_Ac_1 = read.table("ChIP_H3Ac_hda6ldl12_1_TEelement.bed")
hda6ldl12_Ac_2 = read.table("ChIP_H3Ac_hda6ldl12_2_TEelement.bed")
WT_Me2_1 = read.table("ChIP_H3K4me2_WT_1_TEelement.bed")
WT_Me2_2 = read.table("ChIP_H3K4me2_WT_2_TEelement.bed")
hda6_Me2_1 = read.table("ChIP_H3K4me2_hda6_1_TEelement.bed")
hda6_Me2_2 = read.table("ChIP_H3K4me2_hda6_2_TEelement.bed")
ldl12_Me2_1 = read.table("ChIP_H3K4me2_ldl12_1_TEelement.bed")
ldl12_Me2_2 = read.table("ChIP_H3K4me2_ldl12_2_TEelement.bed")
hda6ldl12_Me2_1 = read.table("ChIP_H3K4me2_hda6ldl12_1_TEelement.bed")
hda6ldl12_Me2_2 = read.table("ChIP_H3K4me2_hda6ldl12_2_TEelement.bed")
TE = read.table("tair10_Transposon_element_sorted.bed")
interPeak = data.frame(row.names = TE$V4)
interPeak$WT_Ac = ifelse(row.names(interPeak) %in% WT_Ac_1$V4 & row.names(interPeak) %in% WT_Ac_2$V4, 1,0)
interPeak$hda6_Ac = ifelse(row.names(interPeak) %in% hda6_Ac_1$V4 & row.names(interPeak) %in% hda6_Ac_2$V4, 1,0)
interPeak$ldl12_Ac = ifelse(row.names(interPeak) %in% ldl12_Ac_1$V4 & row.names(interPeak) %in% ldl12_Ac_2$V4, 1,0)
interPeak$hda6ldl12_Ac = ifelse(row.names(interPeak) %in% hda6ldl12_Ac_1$V4 & row.names(interPeak) %in% hda6ldl12_Ac_2$V4, 1,0)
interPeak$WT_Me2 = ifelse(row.names(interPeak) %in% WT_Me2_1$V4 & row.names(interPeak) %in% WT_Me2_2$V4, 1,0)
interPeak$hda6_Me2 = ifelse(row.names(interPeak) %in% hda6_Me2_1$V4 & row.names(interPeak) %in% hda6_Me2_2$V4, 1,0)
interPeak$ldl12_Me2 = ifelse(row.names(interPeak) %in% ldl12_Me2_1$V4 & row.names(interPeak) %in% ldl12_Me2_2$V4, 1,0)
interPeak$hda6ldl12_Me2 = ifelse(row.names(interPeak) %in% hda6ldl12_Me2_1$V4 & row.names(interPeak) %in% hda6ldl12_Me2_2$V4, 1,0)

unionPeak = data.frame(row.names = TE$V4)
unionPeak$WT_Ac = ifelse(row.names(unionPeak) %in% WT_Ac_1$V4 | row.names(unionPeak) %in% WT_Ac_2$V4, 1,0)
unionPeak$hda6_Ac = ifelse(row.names(unionPeak) %in% hda6_Ac_1$V4 | row.names(unionPeak) %in% hda6_Ac_2$V4, 1,0)
unionPeak$ldl12_Ac = ifelse(row.names(unionPeak) %in% ldl12_Ac_1$V4 | row.names(unionPeak) %in% ldl12_Ac_2$V4, 1,0)
unionPeak$hda6ldl12_Ac = ifelse(row.names(unionPeak) %in% hda6ldl12_Ac_1$V4 | row.names(unionPeak) %in% hda6ldl12_Ac_2$V4, 1,0)
unionPeak$WT_Me2 = ifelse(row.names(unionPeak) %in% WT_Me2_1$V4 | row.names(unionPeak) %in% WT_Me2_2$V4, 1,0)
unionPeak$hda6_Me2 = ifelse(row.names(unionPeak) %in% hda6_Me2_1$V4 | row.names(unionPeak) %in% hda6_Me2_2$V4, 1,0)
unionPeak$ldl12_Me2 = ifelse(row.names(unionPeak) %in% ldl12_Me2_1$V4 | row.names(unionPeak) %in% ldl12_Me2_2$V4, 1,0)
unionPeak$hda6ldl12_Me2 = ifelse(row.names(unionPeak) %in% hda6ldl12_Me2_1$V4 | row.names(unionPeak) %in% hda6ldl12_Me2_2$V4, 1,0)

apply(interPeak,2,sum)

table(interPeak$WT_Ac,interPeak$WT_Me2)
table(interPeak$hda6_Ac,interPeak$hda6_Me2)
table(interPeak$ldl12_Ac,interPeak$ldl12_Me2)
table(interPeak$hda6ldl12_Ac,interPeak$hda6ldl12_Me2)


apply(unionPeak,2,sum)
#as.data.frame(apply(unionPeak,2,sum))
table(unionPeak$WT_Ac,unionPeak$WT_Me2)
table(unionPeak$hda6_Ac,unionPeak$hda6_Me2)
table(unionPeak$ldl12_Ac,unionPeak$ldl12_Me2)
table(unionPeak$hda6ldl12_Ac,unionPeak$hda6ldl12_Me2)

